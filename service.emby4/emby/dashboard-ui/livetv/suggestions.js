define(["appRouter","cardBuilder","loading","connectionManager","apphost","layoutManager","focusManager","globalize","dom","emby-itemscontainer","emby-scroller"],function(appRouter,cardBuilder,loading,connectionManager,appHost,layoutManager,focusManager,globalize,dom){"use strict";function LiveTvSuggestionsTab(view,params){this.view=view,this.params=params,this.apiClient=connectionManager.getApiClient(params.serverId),function(view,params){[].forEach.call(view.querySelectorAll(".sectionTitleTextButton-programs"),function(link){var href=link.getAttribute("data-href");href&&(link.href=href+"&serverId="+params.serverId)})}(view,params),view.addEventListener("click",onViewClick),this.onNowItemsContainer=view.querySelector(".activePrograms .itemsContainer"),this.onNowItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getLiveTvChannels({UserId:apiClient.getCurrentUserId(),IsAiring:!0,Limit:24,ImageTypeLimit:1,EnableImageTypes:"Primary,Thumb,Backdrop",EnableTotalRecordCount:!1,Fields:"ProgramPrimaryImageAspectRatio",EnableUserData:!1,SortBy:apiClient.isMinServerVersion("4.4.0.20")?"ChannelNumber,SortName":null})}.bind(this),this.onNowItemsContainer.getItemsHtml=function(items){return getItemsHtml(items,"play",{showTitle:!1,showCurrentProgramParentTitle:!0,showCurrentProgramTitle:!0,showCurrentProgramTime:!0,showCurrentProgramImage:!0,showAirDateTime:!1,showParentTitle:!1,defaultShape:"portrait",action:"programlink"})}.bind(this),this.onNowItemsContainer.parentContainer=dom.parentWithClass(this.onNowItemsContainer,"verticalSection"),this.episodeItemsContainer=view.querySelector(".upcomingEpisodes .itemsContainer"),this.episodeItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getItems(apiClient.getCurrentUserId(),{HasAired:!1,Limit:24,IsSports:!1,IsKids:!1,IsNews:!1,IsSeries:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb",IncludeItemTypes:"Program",Recursive:!0,SortBy:"StartDate,SortName"})}.bind(this),this.episodeItemsContainer.getItemsHtml=function(items){return getItemsHtml(items)}.bind(this),this.episodeItemsContainer.parentContainer=dom.parentWithClass(this.episodeItemsContainer,"verticalSection"),this.movieItemsContainer=view.querySelector(".upcomingTvMovies .itemsContainer"),this.movieItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getItems(apiClient.getCurrentUserId(),{HasAired:!1,Limit:24,IsMovie:!0,IsKids:!1,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb",IncludeItemTypes:"Program",Recursive:!0,SortBy:"StartDate,SortName"})}.bind(this),this.movieItemsContainer.getItemsHtml=function(items){return getItemsHtml(items,null,{shape:"portrait",preferThumb:null,lines:2})}.bind(this),this.movieItemsContainer.parentContainer=dom.parentWithClass(this.movieItemsContainer,"verticalSection"),this.sportsItemsContainer=view.querySelector(".upcomingSports .itemsContainer"),this.sportsItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getItems(apiClient.getCurrentUserId(),{HasAired:!1,Limit:24,IsSports:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb",IncludeItemTypes:"Program",Recursive:!0,SortBy:"StartDate,SortName"})}.bind(this),this.sportsItemsContainer.getItemsHtml=function(items){return getItemsHtml(items,null,{})}.bind(this),this.sportsItemsContainer.parentContainer=dom.parentWithClass(this.sportsItemsContainer,"verticalSection"),this.kidsItemsContainer=view.querySelector(".upcomingKids .itemsContainer"),this.kidsItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getItems(apiClient.getCurrentUserId(),{HasAired:!1,Limit:24,IsKids:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb",IncludeItemTypes:"Program",Recursive:!0,SortBy:"StartDate,SortName"})}.bind(this),this.kidsItemsContainer.getItemsHtml=function(items){return getItemsHtml(items,null,{})}.bind(this),this.kidsItemsContainer.parentContainer=dom.parentWithClass(this.kidsItemsContainer,"verticalSection"),this.newsItemsContainer=view.querySelector(".upcomingNews .itemsContainer"),this.newsItemsContainer.fetchData=function(){var apiClient=this.apiClient;return apiClient.getItems(apiClient.getCurrentUserId(),{HasAired:!1,Limit:24,IsNews:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb",IncludeItemTypes:"Program",Recursive:!0,SortBy:"StartDate,SortName"})}.bind(this),this.newsItemsContainer.getItemsHtml=function(items){return getItemsHtml(items,null,{})}.bind(this),this.newsItemsContainer.parentContainer=dom.parentWithClass(this.newsItemsContainer,"verticalSection")}function onViewClick(e){var textButtonCard=dom.parentWithClass(e.target,"textButtonCard");textButtonCard&&dom.parentWithClass(textButtonCard,"verticalSection").querySelector(".btnMore").click()}function getItemsHtml(items,overlayButton,cardOptions){return cardOptions=cardOptions||{},cardBuilder.getCardsHtml(Object.assign({items:items,preferThumb:"auto",inheritThumb:!1,shape:"autooverflow",showParentTitle:!0,showTitle:!0,centerText:!0,overlayText:!1,lazy:!0,overlayMoreButton:"more"===overlayButton,overlayPlayButton:"play"===overlayButton,showAirTime:!0,showAirDateTime:!0,lines:3,multiSelect:!1},cardOptions))}return LiveTvSuggestionsTab.prototype.onResume=function(options){var promises=[];promises.push(this.onNowItemsContainer.resume(options)),promises.push(this.episodeItemsContainer.resume(options)),promises.push(this.movieItemsContainer.resume(options)),promises.push(this.sportsItemsContainer.resume(options)),promises.push(this.kidsItemsContainer.resume(options)),promises.push(this.newsItemsContainer.resume(options));var scroller=this.view.querySelector(".scrollFrameY");Promise.all(promises).then(function(){options.autoFocus&&focusManager.autoFocus(scroller)})},LiveTvSuggestionsTab.prototype.onPause=function(){this.onNowItemsContainer.pause(),this.episodeItemsContainer.pause(),this.movieItemsContainer.pause(),this.sportsItemsContainer.pause(),this.kidsItemsContainer.pause(),this.newsItemsContainer.pause()},LiveTvSuggestionsTab.prototype.destroy=function(){this.view=null,this.params=null,this.apiClient=null,this.onNowItemsContainer=null,this.episodeItemsContainer=null,this.movieItemsContainer=null,this.sportsItemsContainer=null,this.kidsItemsContainer=null,this.newsItemsContainer=null},LiveTvSuggestionsTab});