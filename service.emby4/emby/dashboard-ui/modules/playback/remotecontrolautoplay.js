define(["events","playbackManager"],function(events,playbackManager){"use strict";events.on(playbackManager,"playerchange",function(e,newPlayer,newTarget,oldPlayer){if(oldPlayer&&(!oldPlayer.isLocalPlayer||newPlayer&&!newPlayer.isLocalPlayer)&&newPlayer&&!newPlayer.isLocalPlayer)return function(oldPlayer,newPlayer){var state=playbackManager.getPlayerState(oldPlayer),item=state.NowPlayingItem;if(item){var resumePositionTicks=(state.PlayState||{}).PositionTicks||0;return playbackManager.stop(oldPlayer).then(function(){playbackManager.play({ids:[item.Id],serverId:item.ServerId,startPositionTicks:resumePositionTicks},newPlayer)})}}(oldPlayer,newPlayer)})});