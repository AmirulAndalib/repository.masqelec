define(["focusManager","inputManager","connectionManager","./searchfields","./searchresults","events","emby-scroller"],function(focusManager,inputManager,connectionManager,SearchFields,SearchResults,events){"use strict";return function(view,params){var self=this;function onSearch(e,value){self.searchResults.search(value)}function onInputCommand(e){"search"===e.detail.command&&(focusManager.focus(view.querySelector(".searchfields-txtSearch")),e.preventDefault())}view.addEventListener("viewshow",function(){self.searchFields||(self.searchFields=new SearchFields({element:view.querySelector(".searchFields")}),self.searchResults=new SearchResults({element:view.querySelector(".searchResults"),serverId:params.serverId||connectionManager.currentApiClient().serverId(),parentId:params.parentId,collectionType:params.collectionType}),events.on(self.searchFields,"search",onSearch)),inputManager.on(window,onInputCommand)}),view.addEventListener("viewbeforehide",function(){inputManager.off(window,onInputCommand)}),view.addEventListener("viewdestroy",function(){self.searchFields&&(self.searchFields.destroy(),self.searchFields=null),self.searchResults&&(self.searchResults.destroy(),self.searchResults=null)})}});